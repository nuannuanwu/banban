<!DOCTYPE html>
<html>
<head>
    <meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
    <meta charset="utf-8">
    <title>班班——萌娃这么晒，绝对是真爱</title>
    <meta name="viewport" content="width=640,target-densitydpi=device-dpi,user-scalable=no"> 
    <meta content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=0" name="viewport"> 
    <meta content="yes" name="apple-mobile-web-app-capable">     
    <meta content="black" name="apple-mobile-web-app-status-bar-style">     
    <meta content="telephone=no" name="format-detection">
    <meta name="viewport" id="viewport" content="width=640"> 
    <link rel="shortcut icon" type="image/ico" href="<?php echo Yii::app()->request->baseUrl; ?>/image/favicon.ico">
    <link rel="stylesheet" href="<?php echo Yii::app()->request->baseUrl; ?>/css/banban/babyface.css" type="text/css"> 
    <script type="text/javascript" async="" src="<?php echo Yii::app()->request->baseUrl; ?>/js/banban/babyface/gs.js"></script>
    <script async="" src="<?php echo Yii::app()->request->baseUrl; ?>/js/banban/babyface/gtm.js"></script>
    <script type="text/javascript" src="<?php echo Yii::app()->request->baseUrl; ?>/js/banban/babyface/Fx.js"></script> 
<style>
body,html{ width:100%; height:100%;}
.page{ height:100%;}
#warps {height:1008px;}
.mus1{ width:640px; position:relative; margin:0 auto; height:1000px;}
#loading{ background:url(/image/banban/babyface/loading.gif) no-repeat center center;position:absolute; z-index:100; width:100px; height: 100px;left:45%; top:45%;display:none; padding-top:35px; text-align:center; float:left; color:#fff; font-size:20px;} 
</style> 
<!--<noscript>&lt;iframe src="//www.googletagmanager.com/ns.html?id=GTM-KW5LDP" height="0" width="0" style="display:none;visibility:hidden"&gt;&lt;/iframe&gt;</noscript>-->
<!--<script>
(function(w,d,s,l,i){
    w[l]=w[l]||[];
    w[l].push({'gtm.start':new Date().getTime(),event:'gtm.js'});
    var f=d.getElementsByTagName(s)[0],j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';
    j.async=true;j.src='//www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f);
})(window,document,'script','dataLayer','GTM-KW5LDP');
</script> -->

<script>
    
function is_weixn(){  
    var ua = navigator.userAgent.toLowerCase();  
    if(ua.match(/MicroMessenger/i)=="micromessenger") {  
        return true;  
    } else {  
        return false;  
    }  
}
 
</script>
</head> 
<body style=" position: relative;  width: 100%;  margin: 0 auto;"> 
<div id="warps" style="width:640px; height: 100%; overflow: hidden; position: relative;">
    <div class="container first">
        <div class="logo"><img src="<?php echo Yii::app()->request->baseUrl; ?>/image/banban/babyface/ban.png" /></div>
        <div class="title"><img src="<?php echo Yii::app()->request->baseUrl; ?>/image/banban/babyface/title.png" /></div>
        <div class="line"><img src="<?php echo Yii::app()->request->baseUrl; ?>/image/banban/babyface/line.png" /></div>
        <div class="text"><img src="<?php echo Yii::app()->request->baseUrl; ?>/image/banban/babyface/text.png" /></div>
        <div class="preload">载入中..<span id="num"></span></div>
        <div class="camera"><img src="<?php echo Yii::app()->request->baseUrl; ?>/image/banban/babyface/camera.png" /></div>
    </div>
    <div id="actRules" class="actRules" style=" display: none;">
        <div class="title">
            <img src="<?php echo Yii::app()->request->baseUrl; ?>/image/banban/babyface/rules.png" />
        </div>
        <div class="content">
            <p>活动主办方：深圳蜻蜓互动科技有限公司</p>
            <p>活动协办方：深圳市报业国际旅行社有限公司综合二营业部<br/>
                　　　　　　深圳导儿运动咨询有限公司<br/>
                　　　　　　4M科文教乐玩具 </p> 
            <div> 活动时间：5月27日-6月2日</div> 
            <div>活动方式：</div>
            <p>1、关注班班微信公众号（banbanyingyong）；</p>
            <p>2、通过公众号菜单进入活动页面；</p>
            <p>3、点击一秒入镜参与活动；</p>
            <p>4、选择要变身的模板，选择图片或拍摄新的图片；</p>
            <p>5、点击确认完成变身；</p>
            <p>6、长按图片即可保存分享给好友（保存图片有惊喜哦~）；</p>
            <p>7、分享此次活动到朋友圈，【朋友圈活动截图+姓名+联系方式】发送给班班，还有机会获得儿童节礼物哦！</p>
            <p>8、活动期间，每天都会抽取幸运粉丝获得礼品哦~</p>
            <div>活动礼品：</div> 
            <p>1、清远牛仔谷动感漂流、溪谷探险一日游（2大1小）</p>
            <p>2、4M 儿童DIY画板(芭蕾舞、蝴蝶、蛋糕、美人鱼4款随机)</p>
            <p>3、《学习困难新突破》——解决孩子学习困难的秘籍</p>
            <p>4、惊喜神秘礼物</p> 
            <div>活动须知：</div>
            <p>1、参与活动获得礼品为随机抽取，礼品不兑换现金不找零；</p>
            <p>2、清远漂流一日游为家庭套票（2位家长+1位儿童），儿童身高须在1.1m以上；</p>
            <p>3、活动期间每天都会抽取幸运用户，次日公布首日名单，以此类推。中奖名单将在班班微信公众号上公布；</p>
            <p>4、中奖名单公布后，工作人员会与中奖粉丝联系并安排发放礼品，请保持手机畅通；</p>
            <p>5、活动参与用户对上传的图片，用户本人对其拥有完全的著作权等相关知识产权和其他的一切权利，上传者不能上传任何违反法律的图片；</p>
            <p>6、用户上传的图片不得涉及任何第三方商标/品牌，侵权内容、政治敏感话题，含种族歧视，暴力倾向内容或违背中国法律法规，若发生因上传图片引起的法律责任，将由用户本人承担责任；</p>
            <p>7、更多问题请关注班班微信公众号或拨打咨询热线：4001013838</p> 
            <div> 
                <p class="last">本次活动最终解释权归深圳蜻蜓互动科技有限公司所有。</p>
            </div>
        </div>
        <div class="iKnow"><span class="close">我知道了</span></div>
    </div>
    <div class="second" style="display:none;">
        <div class="wcshare" style=" display:none;">
            <img src="<?php echo Yii::app()->request->baseUrl; ?>/image/banban/babyface/logo.png">
        </div> 
        <div class="page page4 page_filter" >
            <h3 class="photo_title">
                <img src="<?php echo Yii::app()->request->baseUrl; ?>/image/banban/babyface//choose_text.png">
            </h3>
            <ul class="products_img" id="one_img">
                <li style="display: block;">
                    <img src="<?php echo Yii::app()->request->baseUrl; ?>/image/banban/babyface/1.png">
                </li>
                <li style="display: none;">
                    <img src="<?php echo Yii::app()->request->baseUrl; ?>/image/banban/babyface/2.png">
                </li>
                <li style="display: none;">
                    <img src="<?php echo Yii::app()->request->baseUrl; ?>/image/banban/babyface/3.png">
                </li>
                <li style="display: none;">
                    <img src="<?php echo Yii::app()->request->baseUrl; ?>/image/banban/babyface/4.png">
                </li>
                <li style="display: none;">
                    <img src="<?php echo Yii::app()->request->baseUrl; ?>/image/banban/babyface/5.png">
                </li>
                <li style="display: none;">
                    <img src="<?php echo Yii::app()->request->baseUrl; ?>/image/banban/babyface/6.png">
                </li>
                <li style="display: none;">
                    <img src="<?php echo Yii::app()->request->baseUrl; ?>/image/banban/babyface/7.png">
                </li>
                <li style="display: none;">
                    <img src="<?php echo Yii::app()->request->baseUrl; ?>/image/banban/babyface/8.png">
                </li>
            </ul>
            <div class="changeBg">
                <ul class="products_list" id="one_list">
                    <li class="select" style="padding-left:0;">
                        <img id="bgimg_1" src="<?php echo Yii::app()->request->baseUrl; ?>/image/banban/babyface/s_1.png"  rel="1">
                    </li>
                    <li class="">
                        <img id="bgimg_2" src="<?php echo Yii::app()->request->baseUrl; ?>/image/banban/babyface/s_2.png" rel="2">
                    </li>
                    <li class="">
                        <img id="bgimg_3" src="<?php echo Yii::app()->request->baseUrl; ?>/image/banban/babyface/s_3.png" rel="3">
                    </li>
                    <li class="">
                        <img id="bgimg_4" src="<?php echo Yii::app()->request->baseUrl; ?>/image/banban/babyface/s_4.png" rel="4">
                    </li>
                    <li class="">
                        <img id="bgimg_5" src="<?php echo Yii::app()->request->baseUrl; ?>/image/banban/babyface/s_5.png" rel="5">
                    </li>
                    <li class="">
                        <img id="bgimg_6" src="<?php echo Yii::app()->request->baseUrl; ?>/image/banban/babyface/s_6.png" rel="6">
                    </li>
                    <li class="">
                        <img id="bgimg_7" src="<?php echo Yii::app()->request->baseUrl; ?>/image/banban/babyface/s_7.png" rel="7">
                    </li>
                    <li style="padding-right:0;" class="">
                        <img id="bgimg_8" src="<?php echo Yii::app()->request->baseUrl; ?>/image/banban/babyface/s_8.png" rel="8">
                    </li>
                </ul>
            </div>
            <div class="uploadwarp">
                <span class="btn btn_selfie"><img src="<?php echo Yii::app()->request->baseUrl; ?>/image/banban/babyface/photo.png"></span>
                <div id="inputfile"><input type="file" accept="image/*" capture="camera" id="pic_file"></div>
            </div>
        </div>
        <div class="page page5 page_filter" style="display:none;">
            <h3 class="photo_title">
                <img src="<?php echo Yii::app()->request->baseUrl; ?>/image/banban/babyface//choose_text.png">
            </h3>
            <div class="filter_main">
                <div id="control">
                    <img src="<?php echo Yii::app()->request->baseUrl; ?>/image/banban/babyface/1.png">
                </div>
                <canvas id="piccanvas" width="600" ></canvas>
                <canvas id="piccanvas2" width="600" ></canvas>
                <canvas id="piccanvas3" width="600" ></canvas>
                <canvas id="piccanvas4" width="600"></canvas>
                <canvas id="piccanvas5" width="600"></canvas>
                <canvas id="piccanvas6" width="600"></canvas>
                <canvas id="piccanvas7" width="600"></canvas>
            </div>
            <div class="p5_1">
                <div class="changeBg">
                    <ul id="list_pro" class="products_list" style="padding-top:12px;">
                        <li class="select" style="padding-left:0;">
                            <img src="<?php echo Yii::app()->request->baseUrl; ?>/image/banban/babyface/s_1.png" rel="1">
                        </li>
                        <li><img src="<?php echo Yii::app()->request->baseUrl; ?>/image/banban/babyface/s_2.png" rel="2"></li>
                        <li><img src="<?php echo Yii::app()->request->baseUrl; ?>/image/banban/babyface/s_3.png" rel="3"></li>
                        <li><img src="<?php echo Yii::app()->request->baseUrl; ?>/image/banban/babyface/s_4.png" rel="4"></li>
                        <li><img src="<?php echo Yii::app()->request->baseUrl; ?>/image/banban/babyface/s_5.png" rel="5"></li>
                        <li><img src="<?php echo Yii::app()->request->baseUrl; ?>/image/banban/babyface/s_6.png" rel="6"></li>
                        <li><img src="<?php echo Yii::app()->request->baseUrl; ?>/image/banban/babyface/s_7.png" rel="7"></li>
                        <li style="padding-right:0;">
                            <img src="<?php echo Yii::app()->request->baseUrl; ?>/image/banban/babyface/s_8.png" rel="8">
                        </li>
                    </ul>
                </div>
                <div class="center step1" id="tonext" style="background: #fffcfa;">
                     <div class="rephotograph" >
                         <div id="inputfile2" style=" float: left; width: 310px;  height: 85px;">
                        </div>
                     </div> 
                    <div id="next" tip="0" style="width: 48%; float: left;">
                        <img src="<?php echo Yii::app()->request->baseUrl; ?>/image/banban/babyface/submit.jpg"> 
                    </div>
                </div>                 
            </div>
        </div>
    	 <div id="loading"></div>
        <div class="photo_ok" style="display:none; position: relative;"> 
<!--            <div class="photo_ok_img">
                <img src="/storage/201505/1432349950gcp7t4okonku.png">
            </div>  
            <span class="photo_ok_text1">变身完成！<br>最拉风的萌娃照新鲜出品，还不快晒晒萌娃新造型！<br>长按上方图片保存到本地相册,并分享给好友 </span>
            <div class="photo_ok_text" >
                <a id="linkBnShaer" href=""><img src="<?php echo Yii::app()->request->baseUrl; ?>/image/banban/babyface/shareBtn.png"></a> 
            </div>
            <div class="again">
                <a href="">再试一次</a>
            </div>-->
        </div>
    </div>
    <footer class="photo_footer">
        <a href="" style="border-left:none;">首页</a>
        <a href="javascript:;" class="rules" style="border-right:none;">活动规则</a>
    </footer>
</div>

    <script type="text/javascript" src="<?php echo Yii::app()->request->baseUrl; ?>/js/banban/babyface/jquery.1.4.min.js"></script>
    <script type="text/javascript" src="<?php echo Yii::app()->request->baseUrl; ?>/js/banban/babyface/ajaxfileupload.js"></script>
    <script src="<?php echo Yii::app()->request->baseUrl; ?>/js/banban/babyface/zepto.min.js"></script>
    <script src="<?php echo Yii::app()->request->baseUrl; ?>/js/banban/babyface/binaryajax-exif-megapix-image.min.js"></script>
    <script type="text/vbscript">
        Function IEBinary_getByteAt(strBinary, iOffset)
            IEBinary_getByteAt = AscB(MidB(strBinary, iOffset + 1, 1))
        End Function
        Function IEBinary_getBytesAt(strBinary, iOffset, iLength)
          Dim aBytes()
          ReDim aBytes(iLength - 1)
          For i = 0 To iLength - 1
           aBytes(i) = IEBinary_getByteAt(strBinary, iOffset + i)
          Next
          IEBinary_getBytesAt = aBytes
        End Function
        Function IEBinary_getLength(strBinary)
                IEBinary_getLength = LenB(strBinary)
        End Function
    </script>

    <script src="<?php echo Yii::app()->request->baseUrl; ?>/js/banban/babyface/zepto.make-thumb.js"></script>
    <script src="<?php echo Yii::app()->request->baseUrl; ?>/js/banban/babyface/zepto.edit-canvas.js"></script>  
    <script src="<?php echo Yii::app()->request->baseUrl; ?>/js/banban/babyface/up.js"></script>
    <script src="<?php echo Yii::app()->request->baseUrl; ?>/js/banban/babyface/index_filter.js"></script>
    <script type="text/javascript"> 
        var strPolarBearWebRoot= '<?php echo Yii::app()->createAbsoluteUrl('/wxdev/babyface');?>';
        var strPolarBearPicRoot= '<?php echo Yii::app()->request->baseUrl; ?>/image/banban/babyface/logo.png';
    </script>
    <script type="text/javascript" src="http://res.wx.qq.com/open/js/jweixin-1.0.0.js"></script>
    <script type="text/javascript" src="<?php echo Yii::app()->request->baseUrl; ?>/js/banban/babyface/wcs.js"></script>
    <script type="text/javascript" src="<?php echo Yii::app()->request->baseUrl; ?>/js/banban/babyface/main.js"></script>
<script> 
    wx.config({
        debug: false,
        appId: '<?php echo $signPackage["appId"];?>',
        timestamp: <?php echo $signPackage["timestamp"];?>,
        nonceStr: '<?php echo $signPackage["nonceStr"];?>',
        signature: '<?php echo $signPackage["signature"];?>',
        jsApiList: [
          // 所有要调用的 API 都要加到这个列表中
           //'checkJsApi',
        'onMenuShareTimeline',
        'onMenuShareAppMessage',
        'onMenuShareQQ',
        'onMenuShareWeibo',
        'hideMenuItems',
        'showMenuItems',
        'hideAllNonBaseMenuItem',
        'showAllNonBaseMenuItem',
        'translateVoice',
        'startRecord',
        'stopRecord',
        'onRecordEnd',
        'playVoice',
        'pauseVoice',
        'stopVoice',
        'uploadVoice',
        'downloadVoice',
        'chooseImage',
        'previewImage',
        'uploadImage',
        'downloadImage',
        'getNetworkType',
        'openLocation',
        'getLocation',
        'hideOptionMenu',
        'showOptionMenu',
        'closeWindow',
        'scanQRCode',
        'chooseWXPay',
        'openProductSpecificView',
        'addCard',
        'chooseCard',
        'openCard'
        ]
        });
  
</script>
  <script>
$(document).ready(function () {
    var changeBgWidth, changeBgLiWidth;
    changeBgWidth = $("body").width()*0.9;
    changeBgLiWidth = (changeBgWidth - 40) / 5;
    $("#one_list li,#list_pro li").width(changeBgLiWidth);
    $("#one_list,#list_pro").width(changeBgLiWidth * 9 + 70);  
    
        var imgcount = 0;
        var imglist = ['/image/banban/babyface/1.png', '/image/banban/babyface/s_1.png', '/image/banban/babyface/2.png', '/image/banban/babyface/s_2.png', '/image/banban/babyface/2.png', '/image/banban/babyface/s_3.png', '/image/banban/babyface/4.png', '/image/banban/babyface/s_4.png', '/image/banban/babyface/5.png', '/image/banban/babyface/s_5.png', '/image/banban/babyface/6.png', '/image/banban/babyface/s_6.png', '/image/banban/babyface/7.png', '/image/banban/babyface/s_7.png', '/image/banban/babyface/8.png', '/image/banban/babyface/s_8.png', '/image/banban/babyface/choosePhoto.png', '/image/banban/babyface/choose_text.png','/image/banban/babyface/start.png','/image/banban/babyface/rechoose.jpg','/image/banban/babyface/submit.jpg'];

        preloadimages(imglist, function (percent) {
            imgcount++;
            var percent = parseInt(imgcount / imglist.length * 100) + '%';
            $('#num').html(percent);
        }).done(function (images) {
            $('img[img-src]').each(function () {
                $(this).attr("src", $(this).attr('img-src'));
            });
            setTimeout(function () {
                $('.preload').html("<img class='startbtn' src='/image/banban/babyface/start.png' />");
                $('.startbtn').click(function () {
                    $(".first").hide();
                    $(".second").show();
                });
            }, 500);
        });
        // 查看规则
        $(".rules").click(function () {
            $("#actRules").show(); 
        }); 
        $("#actRules .close").click(function () {
            $("#actRules").hide();
        }); 
        //选择角色
	$("#one_list li").click(function(){
		$(this).addClass("select").siblings().removeClass("select");
		var index=$(this).index();
		$("#one_img li").eq(index).show().siblings().hide();
	});
	//选择角色
	$("#pic_file").click(function(){
            var urlStr ="<?php echo Yii::app()->request->baseUrl; ?>/image/banban/babyface/";
            var M_list=$("#one_list li.select>img").attr("rel");
            $("#control>img").attr("src",urlStr+M_list+".png");
            $("#list_pro li").eq(M_list-1).addClass("select").siblings().removeClass("select");
	});	
	
	$("#list_pro li").click(function(){
           var urlStr ="<?php echo Yii::app()->request->baseUrl; ?>/image/banban/babyface/";
		$(this).addClass("select").siblings().removeClass("select");
		var list=$("#list_pro li.select>img").attr("rel");
		$("#control>img").attr("src",urlStr+list+".png");
		var i=$(this).index();
		$("#one_list li").eq(i).addClass("select").siblings().removeClass("select");
	});
        function GetPageName(str) 
        { 
            var tmp= new Array();//临时变量，保存分割字符串 
            tmp=str.split("/");//按照"/"分割 
            var pp = tmp[tmp.length-1];//获取最后一部分，即文件名和参数  
            return tmp[0]; 
        }
        $("#next").click(function(){ 
            var _this =$(this);
            var urlStrOpen ='<?php echo Yii::app()->createUrl('wxdev/facelift');?>'
            var urlStr='<?php echo Yii::app()->createUrl('wxdev/imagemerge');?>';
            var tip = _this.attr('tip'); 
            //显示loading 
            function time() {
                var i=0;
                var runs = 100; 
                var interval = 20; 
                var loopit = function(){
                    if(i==runs){
                        $("#loading").hide();
                        $(".photo_ok").fadeIn();
                        $(".photo_footer").fadeIn();
                        return;
                    }else{
                        i++;
                        $("#loading").html(i++)
                        $(".photo_ok").hide();
                        $("#loading").show();
                        $(".photo_footer").hide();
                        setTimeout(loopit,interval);
                    }
                }
                loopit();
            } 
            if(tip=='0'){
                time();
                var p1= $("#one_list li.select>img").attr("rel");
                var cvs1= document.getElementById("piccanvas"); 
                var ctx=cvs1.getContext("2d");
                var imgs=document.getElementById("bgimg_"+p1);  
                ctx.drawImage(imgs,0,0); 
                var cvs2= document.getElementById("piccanvas"); 
                var img = cvs2.toDataURL().substring(22);
                $(this).parents(".page5").fadeOut("fast").siblings(".photo_ok").fadeIn("fast");
                $.ajax({
                    url:urlStr+'?tmp='+Math.random()*1000,
                    type:"post",
                    data:"uploadimage="+img+"&p="+p1,
                    dataType:"text",
                    async:false,
                    success:function(date){ 
                        if(date) {
                           //$(".photo_ok_img>img").attr("src",date); 
                           //var flieName = GetPageName(date); 
                           urlStrOpen =urlStrOpen+'?fn='+date+'&p='+p1;
                           //alert(urlStrOpen);
                           //$('#linkBnShaer').attr('href',urlStrOpen);
                            window.location.href=urlStrOpen;
                           //strPolarBearPicRoot =urlStrOpen;
                           _this.attr('tip','0');
                        } else {
                            alert("System Error");
                        }
                    }
                });
                if (window._gsTracker) {
                    _gsTracker.track("/targetpage/template_"+p1+"/confirm");
                }     
            }
	});
	
	setInterval(function(){
		$(".share").animate({"margin-right":"6px"},500,function(){
			$(".share").animate({"margin-right":"0px"})
		});
	},500);

//设置高度
var ua = navigator.userAgent.toLowerCase();
var sUserAgent = navigator.userAgent.toLowerCase();
var bIsIpad = sUserAgent.match(/ipad/i) == "ipad";	
var bIsIphoneOs = sUserAgent.match(/iphone os/i) == "iphone os";
function res(){
	var hh=$(window).height();
	if(bIsIpad){
		if(hh<880&&hh>=820){
			$("#warps").css("height",hh);
			$("#warps").addClass("sml");
		}else{
			$("#warps").addClass("sml");
			$("#warps").css("height",820);
		}
	}
	else {	
		if(hh>=1020){
			$("#warps").removeClass("sml");
			$("#warps").css("height",1020);
		}else if(hh>=880&&hh<1020){
			$("#warps").removeClass("sml");
			$("#warps").css("height",hh);
		}else if(hh<880&&hh>=860){
			$("#warps").css("height",hh);
			$("#warps").addClass("sml");
		}else{
			$("#warps").addClass("sml");
			$("#warps").css("height",860);
			$(".photo_ok_img").css("margin-top","53px");
		}
	}
}

$(function(){
	window.scrollTo(0,0);
	res();
    $(window).resize(function(){
    	res();
    });
	
})

});
</script>


<script>
    //百度统计
    var _hmt = _hmt || [];
    (function() {
      var hm = document.createElement("script");
      hm.src = "//hm.baidu.com/hm.js?1ef1ca666d51f73f124385c51037c5d0";
      var s = document.getElementsByTagName("script")[0]; 
      s.parentNode.insertBefore(hm, s);
    })();
</script>
</body>
</html>